# Kokoro TTS Local Web UI

A local, feature-rich Gradio interface for the **Kokoro** open-weight Text-to-Speech model. This application provides a user-friendly web UI to generate high-quality speech, featuring parallel processing for long texts, advanced text cleaning, and automatic hardware acceleration.

<img width="1138" height="1283" alt="image" src="https://github.com/user-attachments/assets/3d4b74d2-33d8-4cef-ad4e-bc507d490270" />

## âœ¨ Features

* **High-Quality TTS:** Access to all Kokoro voices (US & UK accents).
* **Parallel Processing:** Splits long text into chunks and processes them in parallel threads for significantly faster generation.
* **Hardware Acceleration:** Automatically detects and uses NVIDIA GPU (CUDA) if available, falling back to CPU seamlessly.
* **Text Preprocessing:**
    * Reference number removal (e.g., `[1]`).
    * Whitespace normalization.
    * Initial formatting (e.g., converting "J.R.R." to "J R R").
* **Tokenization Preview:** View the phonemes/tokens generated by the model before audio synthesis.
* **Sample Library:** Quick access to sample texts (Great Gatsby, Frankenstein) or random quotes.

## ğŸ› ï¸ Prerequisites

Before running the application, ensure you have the following installed:

1.  **Python 3.8+**
2.  **eSpeak-ng:** Required for phonemization.
    * **Windows:**
        1. Download and install from [eSpeak-ng releases](https://github.com/espeak-ng/espeak-ng/releases).
        2. **ğŸ§© PowerShell Commands (Run as Administrator)**
           Copy and paste these commands one by one in PowerShell after installing eSpeak NG:
           ```powershell
           $env:PHONEMIZER_ESPEAK_LIBRARY = "c:\Program Files\eSpeak NG\libespeak-ng.dll"
           $env:PHONEMIZER_ESPEAK_PATH = "c:\Program Files\eSpeak NG"
           setx PHONEMIZER_ESPEAK_LIBRARY "c:\Program Files\eSpeak NG\libespeak-ng.dll"
           setx PHONEMIZER_ESPEAK_PATH "c:\Program Files\eSpeak NG"
           ```
    * **Linux:** `sudo apt-get install espeak-ng`
    * **Mac:** `brew install espeak`

## ğŸ“¦ Installation

**Note:** You do **not** need to clone the GitHub repository. You only need the `app.py` script.

1.  **Create a Folder:**
    Manually create a new folder (e.g., named `kokoro`) on your computer.

2.  **Download Script:**
    Download `app.py` and place it inside this folder.

3.  **Set up a Virtual Environment:**
    Open your terminal or command prompt inside this folder and run:

    * **Windows:**
        ```bash
        python -m venv venv
        venv\Scripts\activate
        ```
    * **Linux/Mac:**
        ```bash
        python3 -m venv venv
        source venv/bin/activate
        ```

4.  **Install Dependencies:**
    Install the required packages, including the Kokoro library:
    ```bash
    pip install gradio torch nltk phonemizer scipy soundfile kokoro>=0.9.4
    ```
    *(Note: If you have a specific CUDA version, install the appropriate version of PyTorch from [pytorch.org](https://pytorch.org/).)*

## ğŸš€ Usage

1.  Ensure your virtual environment is activated.
2.  Run the application:
    ```bash
    python app.py
    ```
3.  The application will automatically launch in your default web browser.

## âš™ï¸ Configuration & Controls

### Main Interface
* **Voice:** Select from a variety of US (Heart, Bella, Michael, etc.) and UK (Emma, George, Lewis) voices.
* **Speed:** Adjust the speaking rate (0.5x to 2.0x).
* **Text Cleaning:** Toggle specific preprocessing steps in the "Text Cleaning Options" accordion.

### Performance Tuning
* **Parallel Processing:** Located in the accordion settings.
    * **Slider (1-10):** Controls how many text chunks are processed simultaneously.
    * *Tip:* Higher values use more RAM/VRAM. If you encounter "Out of Memory" errors, reduce this slider.

### Troubleshooting
* **NLTK Errors:** The app attempts to download necessary NLTK data (`punkt`) automatically. If this fails, run `import nltk; nltk.download('punkt')` in a Python shell.
* **eSpeak Errors:** If you see errors related to `EspeakWrapper`, ensure `espeak-ng` is installed and added to your system's PATH. The app includes a monkey-patch to help locate it in standard environments.

## ğŸ“‚ Project Structure

```text
â”œâ”€â”€ app.py                 # Main application file
â”œâ”€â”€ kokoro-v0_19.pth       # Model weights (Downloaded automatically on first run)
â”œâ”€â”€ venv/                  # Virtual environment folder (created during installation)
â”œâ”€â”€ en.txt                 # (Optional) Source for random quotes
â”œâ”€â”€ gatsby5k.md            # (Optional) Sample text
â””â”€â”€ frankenstein5k.md      # (Optional) Sample text
```

## ğŸ“œ License
This project relies on the Kokoro TTS model. Please refer to the original model's license for usage restrictions.

### Acknowledgements
- ğŸ› ï¸ [@yl4579](https://huggingface.co/yl4579) for architecting StyleTTS 2.
- ğŸ† [@Pendrokar](https://huggingface.co/Pendrokar) for adding Kokoro as a contender in the TTS Spaces Arena.
- ğŸ“Š Thank you to everyone who contributed synthetic training data.
- â¤ï¸ Special thanks to all compute sponsors.
- ğŸ‘¾ Discord server: https://discord.gg/QuGxSWBfQy
- ğŸª½ Kokoro is a Japanese word that translates to "heart" or "spirit". Kokoro is also a [character in the Terminator franchise](https://terminator.fandom.com/wiki/Kokoro) along with [Misaki](https://github.com/hexgrad/misaki?tab=readme-ov-file#acknowledgements).

<img src="https://static0.gamerantimages.com/wordpress/wp-content/uploads/2024/08/terminator-zero-41-1.jpg" width="400" alt="kokoro" />
